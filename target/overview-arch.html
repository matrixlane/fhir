<!DOCTYPE HTML>

[%settitle FHIR概述-开发者%]
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="zh" lang="zh">
<head>
[%file newheader%]

</head>

<body>
[%file newnavbar%]



<h2>FHIR概述 - 架构师</h2>
<table class="colsi"><tr><td id="wg"><a _target="blank" href="[%wg fhir%]">[%wgt fhir%]</a> 工作组</td><td id="fmm"><a href="versions.html#maturity">成熟度级别</a>: N/A</td><td id="ballot"><a href="versions.html#std-process">标准状态</a>:<!--!ns!--><a href="versions.html#std-process">信息性</a></td></tr></table>

<p>
在其核心，FHIR包含两个主要组件：
</p>
<ol>
 <li>资源 - 一组信息模型，定义了与医疗保健最相关的“业务对象”的数据元素、约束和关系。从模型驱动架构的角度来看，FHIR资源在概念上相当于以XML或JSON实现的物理模型。请参阅<a href="resource.html">正式定义</a>。</li>
 <li>API - 一组明确定义的接口，用于两个应用程序之间的互操作。虽然不是必需的，但FHIR规范针对API实现的目标是RESTful接口。请参阅<a href="http.html">有关FHIR RESTful接口的详细信息</a>。</li>
</ol>
<p>
在医疗保健领域，"业务对象"的集合没有普遍定义，但存在一种概念上的、持续演进的、基于共识的过程，用于标准化一组核心的常见业务对象，包括"患者"、"手术"、"观察"、"医嘱"等（请参阅<a href="resourcelist.html">定义资源的列表</a>）。FHIR规范提供了一个框架，用于定义这些医疗保健业务对象（"资源"），以一种组合的方式将它们关联在一起，以可计算的形式实现它们，并通过明确定义的接口共享它们。该框架包含一个可验证和可测试的语法，一组规则和约束，用于"FHIR-aware" API的方法和接口签名，以及用于请求和传递FHIR业务对象的服务器的实现规范。
</p>
<p>
从操作角度来看，HL7的内部标准开发和治理过程决定了什么构成资源以及哪些资源存在。此外，FHIR规范还提供了一种为特定需求在特定范围内上下文化资源的机制（请参阅<a href="profiling.html">资源配置文件</a>）。
</p>
<a name="frameworks"></a>
<h3>架构框架和FHIR的对齐</h3>
<p>
FHIR资源紧密配合信息架构领域，而FHIR用于数据交换的API则涉及应用程序架构的方面。
</p>
<table class="none">
<tr>
<td>
<p>
从<a href="http://www.opengroup.org/subjectareas/enterprise/togaf">TOGAF的角度</a>来看，FHIR解决了与信息模型定义和数据交换相关的架构视图的方面，这些视图在TOGAF架构开发方法的信息系统架构部分中进行了描述。
</p>
</td>
<td>
<p>
<img src="togaf.png" width="235" height="300"/>
</p>
</td>
</tr>
<tr>
<td>
<p>
就<a href="https://www.zachman.com">Zachman框架</a>而言，FHIR适用于架构师、工程师和技术人员视角中的What和How维度。
</p>
</td>
<td>
<p>
<img src="zachman.png" width="392" height="376"/>
</p>
</td>
</tr>
<tr>
<td>
<p>
在考虑<a href="http://www.hl7.org/implement/standards/product_brief.cfm?product_id=3">HL7服务感知互操作性框架（SAIF）</a>时，FHIR资源和RESTful API分别代表信息模型和行为模型视图中的平台特定规范层中的“物理模型”和“接口实现”。
</p>
</td>
<td>
<p>
<img src="saif.png" width="461" height="202"/>
</p>
</td>
</tr>
</table>
<a name="principles"></a>
<h3>FHIR和架构原则</h3>
<p>
FHIR的主要目的是解决与结构化、表达丰富的数据模型和简单高效的数据交换机制的互操作性问题。此外，FHIR符合以下架构原则：
</p>
<ol>
<li>
重用和可组合性 - FHIR资源的设计考虑了80/20法则 - 关注满足80%互操作性需求的20%要求。为此，资源的设计旨在满足许多用例的一般或常见数据需求，以避免大量重叠和冗余的资源的产生。存在扩展和自定义（请参阅<a href="profiling.html">FHIR配置文件</a>），以允许采用常见的、相对通用的资源，并根据特定用例的需求进行调整。此外，FHIR资源具有高度的可组合性，因为资源通常引用其他资源。这进一步促进了重用，并允许从更原子化的资源构建复杂结构。
</li>
<li>
可扩展性 - 将FHIR API与REST架构风格对齐，确保所有事务都是无状态的，从而减少内存使用量，消除了服务器群中的“粘性”会话需求，从而支持水平扩展。
</li>
<li>
性能 - FHIR资源精简且适合在网络上进行交换。提供了高度优化的格式，这有可能提高通过共享和有限网络连接的多个系统之间的复杂事务的性能，尽管大多数实施者认为标准的JSON / XML格式已经足够。
</li>
<li>
可用性 - FHIR资源被技术专家和非技术人员都能理解。即使不了解XML或JSON语法的细节，非技术人员也可以在任何浏览器或文本阅读器中查看它们并理解其中的内容。
</li>
<li>
数据准确性 - FHIR具有强类型，并内置了临床术语链接和验证机制。此外，XML和JSON文档可以在语法上和根据一组定义的业务规则进行验证。这促进了高数据准确性，并在很大程度上利用FHIR实现语义互操作性。
</li>
<li>
可实施性 - FHIR的驱动力之一是需要创建一个在不同开发者社区中广泛采用的标准。FHIR易于理解，并使用行业标准和常见的标记和数据交换技术进行实施。
</li>
</ol>
<p>
还有与一致性、粒度、引用完整性等相关的其他架构原则，这些原则尚未得到很好的建立或验证。有关详细信息，请参阅下面的未解决问题部分。
</p>
<a name="decomposition"></a>
<h3>FHIR分解</h3>
<p>
如前所述，FHIR的主要组成部分是资源和RESTful API。然而，FHIR规范还包括以下组件。
</p>
<blockquote>
<p>
注意：术语“组件”在此处使用宽泛的意义上，表示某个事物的一部分，并不打算承载严格的本体论、建模框架或其他架构和组织结构提供的该术语的具体含义。在图示上，这些组件被描绘为UML类。这样做纯粹是为了利用使用此符号所提供的语义。FHIR在建模方法上既不是面向对象的，也不是组成FHIR规范的组件在形式上是UML类或对象。同样，下面显示的UML包是概念上的，仅用于组织目的。
</p>
</blockquote>
<p>
如下图所示，方便地将FHIR规范视为具有以下组件的组成部分：
</p>
<ul>
<li>
信息模型 - 与创建FHIR资源相关的FHIR组件
</li>
<li>
约束 - 处理约束和有效性的FHIR组件
</li>
<li>
术语 - 与临床术语和本体相关的FHIR组件
</li>
<li>
用法 - 处理FHIR在运行时的使用的FHIR组件
</li>
</ul>
<p>
<img src="layout.png" width="600" height="460" style="float: none"/>
</p>
<p>
组件定义：
</p>
<ul>
  <li>FHIR信息模型
    <ul>
      <li>基类：<a href="types.html#Element">Element</a>和<a href="resource.html">Resource</a></li>
      <li>基类定义：<a href="elementdefinition.html">ElementDefinition</a>和<a href="structuredefinition.html">StructureDefinition</a></li>
      <li><a href="datatypes.html">数据类型</a></li>
    </ul>
  </li>
  <li>FHIR一致性模型
    <ul>
      <li><a href="capabilitystatement.html">能力声明</a></li>
      <li><a href="profiling.html">配置文件</a></li>
    </ul>
  </li>
  <li>FHIR术语
    <ul>
      <li><a href="codesystem.html">代码系统</a></li>
      <li><a href="valueset.html">值集</a></li>
    </ul>
  </li>
  <li>FHIR用法
    <ul>
      <li><a href="http.html">REST API</a></li>
    </ul>
  </li>
</ul>

<a name="creating"></a>
<h3>创建资源 - 架构考虑因素</h3>

<p>
以下列表提供了在定义FHIR资源时适用的一般准则。其中大部分项目不会在程序上强制执行，需要人工的尽职调查和治理来确保遵守。
</p>
<ul>
<li>资源应具有明确的边界，与一个或多个逻辑事务范围相匹配</li>
<li>资源应在含义上有所区别，而不仅仅是在用法上有所区别（例如，使用实验室报告的每种不同方式不应导致不同的资源）</li>
<li>资源需要具有自然标识</li>
<li>大多数资源应非常常见，并在许多不同的业务交易中使用</li>
<li>资源不应具体或详细到无法支持广泛的业务交易</li>
<li>资源应互斥[这是一个非常重要的考虑因素，有助于减少冗余和歧义]</li>
<li>资源应使用其他资源，但它们不应仅仅是其他资源的组合；每个资源应引入新颖的内容</li>
<li>资源应根据资源的共性和其链接内容进行逻辑框架的组织（参见下面的资源框架）</li>
<li>资源应足够大，以提供有意义的上下文；只包含少数属性的资源可能太小，无法提供有意义的业务价值</li>
<li>资源应反映一般的使用情况：
  <ul>

<li>如果大多数系统将某个内容视为单一概念，则建议使用单一资源；如果大多数系统将某个内容视为不同的概念，则建议使用多个资源。</li>
<li>如果对于“资源”的两种不同用法会导致对“核心”概念的解释产生极大差异，则建议使用两个资源。</li>
</ul>
</li>
<li>倾向于使用较少的资源而不是更多的资源。</li>
</ul>

<a name="organizing"></a>
<h3>组织FHIR资源</h3>
<p>
在一个单一的信息模型中建模整个健康数据是不切实际的。从HL7版本2消息规范到FHIR资源的每个建模倡议都将医疗领域分解为更小、更可管理的子领域或信息模型片段。对于FHIR来说，每个资源本质上都是较大的医疗信息领域的一个片段。
</p>
<p>
在将医疗信息模型分解为较小的块（或FHIR资源）时，有一个框架和一套指南来促进资源结构的一致性和完整性以及资源之间的引用方式非常重要。下面的框架包括基于常见程度的层次结构中组织的健康信息模型子类别。这些层次和类别对于确定医疗信息的哪些部分是最常见的，并且因此需要最一致地定义和严格管理非常有用。顶层的类别是最常见的，包含支持最多常见医疗事务的FHIR资源。
</p>
<p>
框架中各层的描述：
</p>
<ol>
<li><b>基础资源</b>：基础资源是最基本的、基础的资源。它们通常用于基础设施任务。虽然不是禁止的，但它们并不总是被其他资源引用。</li>
<li><b>基本资源</b>：第二层包含基本资源。这些通常是资源图的叶节点。换句话说，它们通常被其他资源引用，但通常不引用其他资源本身。这些资源通常是最常用的，因此需要最高程度的一致性和架构严谨性。对于第一层和第二层的资源，治理最为严格。</li>
<li><b>临床资源</b>：第三层包括临床性质的资源，但在许多用例中也非常常见。这包括临床观察、临床治疗、护理提供和药物等资源。这些资源可以单独使用，但通常是基于第二层资源构建的。例如，观察资源将引用第二层的患者资源。当这些资源被第三、四和五层的资源引用时，它们通常也会被上下文化。</li>
<li><b>财务资源</b>：第四层专门用于财务资源。从逻辑上讲，财务资源建立在临床和基础资源的基础上。例如，一个账单资源将引用临床事件和活动，以及像患者这样的基础资源。</li>
<li><b>专业资源</b>：在第五层，我们可以找到更专业的资源，用于较不常见的用例。这些资源几乎总是引用较低层的资源。鉴于FHIR优先满足最常见的用例，这一层的资源较少。</li>
<li><b>资源上下文化</b>：第六层不包含资源。然而，它扩展了由前五层资源组成的组合框架。第六层包括配置文件和图形。配置文件用于扩展、约束或以其他方式为给定目的上下文化资源。图形是资源的组合，或者是包含自己属性的资源网。</li>
</ol>
<p>
<img src="framework-2.png" style="float: none"/>
</p>
<p>
根据这个框架组织的完整的FHIR资源集合可以在<a href="resourcelist.html">资源页面</a>找到。
</p>
<p>
该框架有三个主要目的：
</p>
<ol>
 <li>为导航和识别资源进行组织</li>
 <li>根据常识的分组或描述资源在同一类别中的预期结构和/或行为模式对资源进行分类</li>
 <li>将资源分层分布以分层相对常见性，最常见的资源位于顶层</li>
</ol>

<p>
目的2和目的3为未来的架构严谨性和资源治理奠定了基础，以优化未来新资源或改进资源的一致性、完整性和可预测性。实际的规则和模式将在未来的FHIR版本中定义和完善。然而，现在可以提出一个一般性的指导原则，即资源通常引用同一层或更高层的资源。换句话说，第4层资源通常只引用第4、3、2或1层的资源。并没有禁止第4层资源引用第5层资源，但这种情况并不常见。根据这个指导原则，可以确定在各种用例中可能最常见的资源，并因此需要最高程度的一致性和治理。此外，该框架有助于确定创建新的FHIR资源的优先级最高的领域。通常，在较高层（第1、2和3层）创建FHIR资源的优先级较高，而在较低层（第4和5层）创建FHIR资源的优先级较低，因为较高层资源将为最多的用例和利益相关者提供最大的价值。这并不是说较高层所需的业务交易不重要，只是在整个医疗保健领域中并不常见。
</p>
<p>
框架的第6层实际上不是资源。配置文件和图形是资源的扩展或资源组合，它们延续了FHIR组合框架的进展，并提供了满足某些用例所需的附加上下文。
</p>
<p>
将FHIR资源的创建与该框架对齐预计会带来几个好处，包括：
</p>
<ul>
<li>健康领域的组织和可管理性-该框架为分解和模块化提供了基础</li>
<li>识别共性-该框架从不太常见的领域中提取出共同点</li>
<li>FHIR资源优先级-该框架为确定优先级和委派工作提供了结构</li>
<li>分层治理级别-该框架将需要最严格和普遍治理的领域与需要更多上下文特定治理的领域分开</li>
</ul>
<p>
该框架在<a href="https://confluence.hl7.org/display/FHIR/Resource+Considerations">FHIR资源考虑页面</a>中进一步阐述。
</p>
<p>
另一个有用的工具，用于可视化FHIR资源相对于彼此的组织方式，可以在<a href="https://fhirblog.com/2016/06/14/resource-reference-visualization-in-clinfhir/">clinFHIR</a>上找到。
</p>
<a name="implementations"></a>
<h3>FHIR实施-高级设计考虑因素</h3>
<a name="APIs"></a>
<h4>FHIR服务器和FHIR API</h4>
<p>
FHIR REST服务器是任何实现FHIR API并使用FHIR资源交换数据的软件。下图描述了FHIR接口定义。这些方法被分类为：
</p>
<ul>
<li>
iServeInstance-在资源上执行Get、Put或Delete操作的方法
</li>
<li>
iServeType-获取有关资源的类型信息或元数据的方法
</li>
<li>
iServeSystem-公开或启用系统行为的方法。
</li>
</ul>
<p>
有关FHIR API的更多详细信息，请参见<a href="http.html">FHIR RESTful API</a>和<a href="operations.html">操作框架</a>。
</p>
<p>
<img src="arch-uml1.png" width="600" height="332" style="float: none"/>
</p>
<a name="transactions"></a>
<h4>FHIR事务</h4>
<p>
如前所述，FHIR资源针对与RESTful API进行无状态事务进行了优化。虽然这不是使用FHIR资源的唯一方式，但这些类型的事务是FHIR规范中定义的唯一具有定义接口和行为的事务。
</p>
<p>
FHIR事务遵循简单的请求和响应事务模式。请求和响应可以是单个有效负载，也可以作为批处理操作。请求和响应的有效负载包括头部和感兴趣的内容。有关详细信息，请参见下图。
</p>
<p>
<img src="arch-uml2.png" width="600" height="502" style="float: none"/>
</p>
<a name="security"></a>
<h4>安全性</h4>
<p>
<i>（部分待填写）</i>（但请参见<a href="security.html">安全性</a>）。
</p>
<p>
使用FHIR的示例用例
</p>
<p>
为了说明问题，下图描述了一个简单的用例，即患者通过底层的电子病历（EMR）系统访问其个人健康记录（门户）。在此示例中，EMR扮演了FHIR服务器的角色。
</p>
<p>
此用例的前提条件是：
</p>
<ul>
<li>
EMR实现了必要的FHIR API
</li>
<li>
EMR实现了必要的身份验证和授权机制
</li>
<li>
患者成功通过身份验证和授权以访问FHIR资源
</li>
</ul>
<p>
该用例的基本流程是，患者注册（如果需要），登录，输入搜索条件以识别感兴趣的患者或患者（在此用例中，患者最像自己），检索患者的临床文档和检索患者的临床资源。该用例利用iServeInstance接口上的GET方法，并使用以下类型的FHIR资源：
</p>
<ul>
<li>
患者资源
</li>
<li>
一个或多个文档资源
</li>
<li>
一个或多个临床资源
</li>
</ul>
<p>
<img src="arch-uml3.png" width="600" height="426" style="float: none"/>
</p>
<p>
尽管此示例用例非常简单，但可以设想使用GET、PUT和DELETE的组合进行更复杂的事务。然而，这些用例的确切细节，包括使用哪些方法、方法的编排和涉及的具体资源，超出了FHIR规范的范围。
</p>
<a name="issues"></a>
<h3>未解决的问题</h3>
<ul>
<li>
<b>资源一致性和粒度</b> - 没有任何固有的限制，禁止一个资源复制另一个资源的相同信息。此外，没有任何限制资源以不同方式定义和建模数据元素的相同信息。
HL7有许多流程来确保资源的一致性设计，但问题是何时在规范内保持一致，何时与医疗保健的实际实践保持一致 - 这两者有时是相互冲突的。
资源粒度是一个相关的潜在问题，因为现有资源的大小、复杂性和全面性存在差异。
<br/>
<br/>
此外，FHIR规范可以强制实施一致性的程度受到在各个社区之间获得多少一致性的限制。虽然<a href="safety.html">实施者安全检查清单</a>和
<a href="https://confluence.hl7.org/display/FHIR/Resource+Considerations">FHIR资源考虑事项</a>提供指导并促进一致性，
但在内容和粒度方面实现完全一致性的规则既没有完全定义也没有完全执行。
考虑到FHIR仍然是一个新兴的标准，为了最大限度地促进初始采用，避免了过多的约束和严谨性。此外，一致性和架构美德以及支持实际医疗保健实践的实际问题之间存在自然的紧张关系。
考虑到FHIR最终是对其支持的健康业务流程的反映，FHIR将始终保留一些在不同组织和从业者的实践中存在的数据差异、不一致性和差距。
尽管如此，资源一致性和粒度的问题是一个持续讨论的话题，并且可能会随着FHIR接近最终规范和FHIR采用达到需要更多控制或现有医疗保健系统中的信息/流程一致性的水平而发生变化。
</li>
<li>
<b>资源引用</b> - 目前缺乏严格的规则，规定资源应该在什么情况下引用其他资源。可能存在歧义、重复、不准确和/或冲突的信息通过资源图（一组链接的资源）进行传递的可能性。
想象一下这样的情况，资源类型A（例如，过程）引用资源类型B（例如，遭遇）和资源类型C（例如，患者），而资源类型B（例如，遭遇）也引用资源类型C（例如，患者）。
在这种情况下，资源A对资源C的引用是否意味着提供与资源B对资源C的引用相同的信息？如果是这样，信息的重复是否有问题？请注意，这不是FHIR独有的 - 它是信息系统的固有属性。
如果A的实际实例和它引用的B引用不同的C实例（例如，该过程引用患者X和患者Y的遭遇），系统如何知道引用是有意不同还是错误或数据异常？问题在于描述引用的意图的能力有限，这导致可能存在歧义和错误。
<a href="linkage.html">链接资源</a>可用于帮助解决此问题，但将来可能考虑其他功能，以允许系统处理引用完整性。
</li>
<li>
<b>条件语义</b> - 目前，元素定义的约束，包括数据类型、值集、可选性和基数等方面的约束，是在设计时定义的，对变量运行时语义的考虑有限。
想象一下这样的情况，在给定资源的特定实例中，数据元素Y（例如，“不耐受类型”）的值根据数据元素X（例如，“致敏剂”）的值而有所不同的约束。
例如，如果Intolerance资源的实例将“不耐受类型”数据元素填充为“食物不耐受”，那么“致敏剂”应该被约束为仅对该值集（例如，有效食物而不是药物或环境因素）有效的值。解决这个问题的工具只是逐渐发展中。
</li>
<li>
<b>业务规则执行和验证</b> - 随着治理的增加和定义更多资源规则，拥有一个资源验证工具可能是有利的，该工具可以检查资源的一致性、重复性、引用完整性、循环或荒谬的引用以及其他定义和批准的验证规则。
一旦规则得到认可，这种级别的自动化可以帮助解决上述其他问题。这些类型的设施计划在未来实现。
</li>
</ul>

[%file newfooter%]

</body>
</html>



